<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="常用二十种设计模式, joytsing blog"><meta name="description" content="唉，设计模式"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="theme-color" content="white"><title>常用二十种设计模式 | JoyTsing</title><link rel="apple-touch-icon" href="/"><link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre!important}</style><script src="/libs/jquery/jquery.min.js"></script><script src="https://cdn-go.cn/aegis/aegis-sdk/latest/aegis.min.js"></script><script>const aegis=new Aegis({id:"6ojk8FlnQlqWeL6vQo",uin:"joyblog",reportApiSpeed:!0,reportAssetSpeed:!0,spa:!0,hostUrl:"https://rumt-sg.com"});console.log("aegis load")</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="JoyTsing" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/apple-touch-icon.png" class="logo-img" alt="LOGO"> <span class="logo-span">JoyTsing</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fa fa-home"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa fa-tags"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa fa-bookmark"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa fa-archive"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa fa-user-circle-o"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa fa-envelope"></i> <span>留言</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa fa-address-book"></i> <span>友链</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fa fa-search" title="搜索"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/avatars/touxiang2.jpg" class="logo-img circle responsive-img"><div class="logo-name">JoyTsing</div><div class="logo-desc">joytsing的个人网站</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa fa-fw fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa fa-fw fa-user-circle-o"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa fa-fw fa-envelope"></i> 留言</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa fa-fw fa-address-book"></i> 友链</a></li><li><div class="divider"></div></li><li><a href="https://github.com/JoyTsing" class="waves-effect waves-light" target="_blank"><i class="fa fa-github-square fa-fw"></i>Follow Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#000;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/JoyTsing" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Follow Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/3.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">常用二十种设计模式</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Cpp/"><span class="chip bg-color">Cpp</span> </a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="chip bg-color">设计模式</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/Cpp/" class="post-category">Cpp</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp; 2024-04-27</div><div class="post-date info-break-policy"><i class="fa fa-calendar-check-o fa-fw"></i>更新日期:&nbsp;&nbsp; 2024-04-27</div><div class="info-break-policy"><i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp; 13.2k</div><div class="info-break-policy"><i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp; 52 分</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp; <span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>C++中常用的设计模式有很多，设计模式是解决常见问题的经过验证的最佳实践。以下是一些常用的设计模式：</p><ol><li><strong>单例模式（Singleton）</strong>：确保一个类只有一个实例，并提供一个全局访问点。</li><li><strong>工厂模式（Factory）</strong>：用于创建对象，而不需要指定具体类。</li><li><strong>抽象工厂模式（Abstract Factory）</strong>：提供一组相关或相互依赖的对象，而不指定其具体类。</li><li><strong>建造者模式（Builder）</strong>：将一个复杂对象的构建与其表示分离，使相同的构建过程可以创建不同的表示。</li><li><strong>原型模式（Prototype）</strong>：通过克隆已有对象来创建新对象，以避免直接使用构造函数。</li><li><strong>适配器模式（Adapter）</strong>：将一个接口转换成另一个客户希望使用的接口。</li><li><strong>装饰器模式（Decorator）</strong>：动态地给一个对象添加一些额外的职责，而不需要子类化。</li><li><strong>代理模式（Proxy）</strong>：为其他对象提供一个代理以控制对这个对象的访问。</li><li><strong>观察者模式（Observer）</strong>：定义了一种一对多的依赖关系，当一个对象状态改变时，所有依赖它的对象都会得到通知。</li><li><strong>策略模式（Strategy）</strong>：定义一系列算法，封装它们，使它们可以相互替换。</li><li><strong>命令模式（Command）</strong>：将一个请求封装成一个对象，从而允许使用不同的请求、队列或日志请求。</li><li><strong>状态模式（State）</strong>：允许对象在其内部状态改变时改变其行为。</li><li><strong>模板方法模式（Template Method）</strong>：定义算法的骨架，允许子类重写其中的步骤。</li><li><strong>访问者模式（Visitor）</strong>：表示一个作用于某对象结构中的各元素的操作，它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。</li><li><strong>组合模式（Composite）</strong>：将对象组合成树形结构以表示“部分-整体”的层次结构。</li><li><strong>迭代器模式（Iterator）</strong>：提供一种方法顺序访问一个聚合对象中各个元素，而又不暴露该对象的内部表示。</li><li><strong>中介者模式（Mediator）</strong>：定义一个对象，封装一系列对象之间的交互，从而降低对象之间的耦合度。</li><li><strong>备忘录模式（Memento）</strong>：不破坏封装的前提下，捕获一个对象的内部状态，并在对象之外保存这个状态。</li><li><strong>桥接模式（Bridge）</strong>：将抽象部分与它的实现部分分离，使它们可以独立变化。</li><li><strong>解释器模式（Interpreter）</strong>：给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来解释语言中的句子。</li></ol><h2 id="1-单例模式"><a href="#1-单例模式" class="headerlink" title="1.单例模式"></a>1.单例模式</h2><p><strong>提供所有设计模式的 C++ 示例代码是一个庞大的任务，但我可以为您提供一个示例，演示如何使用 C++ 实现一个常见的设计模式——单例模式（Singleton）。</strong></p><p><strong>单例模式（Singleton） 确保一个类只有一个实例，并提供全局访问点。以下是一个基本的单例模式示例：</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> Singleton<span class="token operator">&amp;</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">static</span> Singleton instance<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 静态局部变量确保只初始化一次</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Singleton is doing something."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// 构造函数私有，只能通过 getInstance() 获取实例</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 获取 Singleton 实例</span>
    Singleton<span class="token operator">&amp;</span> singleton <span class="token operator">=</span> Singleton<span class="token operator">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    singleton<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，<code>Singleton</code> 类的构造函数是私有的，这意味着外部无法直接创建 <code>Singleton</code> 对象。通过 <code>getInstance()</code> 静态成员函数，我们可以获取到单一的 <code>Singleton</code> 实例。这确保了只有一个实例存在。 单例模式常用于需要共享资源或控制访问某些全局状态的情况。在实际项目中，设计模式的选择会根据具体需求和架构决策，不同的模式可能会以不同的方式被实现和使用。</p><h2 id="2-工厂模式"><a href="#2-工厂模式" class="headerlink" title="2.工厂模式"></a>2.工厂模式</h2><p>工厂模式（Factory Pattern）是一种创建型设计模式，用于创建对象而无需指定对象的具体类。工厂模式通过定义一个共同的接口，由不同的工厂子类来实现，并根据不同的情况返回不同的具体对象。</p><p>以下是一个简单的工厂模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 抽象产品类</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体产品类 A</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteProductA</span> <span class="token operator">:</span> <span class="token keyword">public</span> Product <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Product A in use."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体产品类 B</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteProductB</span> <span class="token operator">:</span> <span class="token keyword">public</span> Product <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Product B in use."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 抽象工厂类</span>
<span class="token keyword">class</span> <span class="token class-name">Factory</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> Product<span class="token operator">*</span> <span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体工厂类 A，用于创建 ProductA</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteFactoryA</span> <span class="token operator">:</span> <span class="token keyword">public</span> Factory <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Product<span class="token operator">*</span> <span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体工厂类 B，用于创建 ProductB</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteFactoryB</span> <span class="token operator">:</span> <span class="token keyword">public</span> Factory <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Product<span class="token operator">*</span> <span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 使用具体工厂类 A 创建产品 A</span>
    Factory<span class="token operator">*</span> factoryA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteFactoryA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Product<span class="token operator">*</span> productA <span class="token operator">=</span> factoryA<span class="token operator">-</span><span class="token operator">></span><span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productA<span class="token operator">-</span><span class="token operator">></span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 使用具体工厂类 B 创建产品 B</span>
    Factory<span class="token operator">*</span> factoryB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteFactoryB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Product<span class="token operator">*</span> productB <span class="token operator">=</span> factoryB<span class="token operator">-</span><span class="token operator">></span><span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productB<span class="token operator">-</span><span class="token operator">></span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">delete</span> factoryA<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> factoryB<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> productA<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> productB<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们定义了抽象产品类 <code>Product</code>，有两个具体的产品类 <code>ConcreteProductA</code> 和 <code>ConcreteProductB</code>，它们都继承自 <code>Product</code>。然后，我们定义了抽象工厂类 <code>Factory</code>，有两个具体工厂类 <code>ConcreteFactoryA</code> 和 <code>ConcreteFactoryB</code>，它们分别负责创建不同的产品。</p><p>通过使用工厂模式，我们可以根据具体的需求选择不同的工厂类来创建产品，而无需关心产品的具体类是什么。这提供了灵活性，允许我们轻松扩展和替换具体产品和工厂类。</p><p>这是一个简单的示例，实际中工厂模式可用于更复杂的对象创建需求。工厂模式常用于创建对象的场景，特别是在代码中需要降低耦合性时非常有用。</p><h2 id="3-抽象工厂模式"><a href="#3-抽象工厂模式" class="headerlink" title="3.抽象工厂模式"></a>3.抽象工厂模式</h2><p>抽象工厂模式（Abstract Factory Pattern）是一种创建型设计模式，它提供了一个接口，用于创建一系列相关或依赖的对象，而不需要指定它们的具体类。抽象工厂模式的核心思想是为每个产品族（相关的一组产品）定义一个抽象工厂，然后在每个具体工厂中实现该抽象工厂。</p><p>以下是一个简单的抽象工厂模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 抽象产品 A</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractProductA</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">useA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体产品 A1</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteProductA1</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractProductA <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">useA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Product A1 in use."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体产品 A2</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteProductA2</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractProductA <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">useA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Product A2 in use."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 抽象产品 B</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractProductB</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">useB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体产品 B1</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteProductB1</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractProductB <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">useB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Product B1 in use."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体产品 B2</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteProductB2</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractProductB <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">useB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Product B2 in use."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 抽象工厂</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractFactory</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> AbstractProductA<span class="token operator">*</span> <span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> AbstractProductB<span class="token operator">*</span> <span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体工厂 1</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteFactory1</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractFactory <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    AbstractProductA<span class="token operator">*</span> <span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteProductA1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    AbstractProductB<span class="token operator">*</span> <span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteProductB1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体工厂 2</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteFactory2</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractFactory <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    AbstractProductA<span class="token operator">*</span> <span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteProductA2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    AbstractProductB<span class="token operator">*</span> <span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteProductB2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 使用具体工厂 1 创建产品 A 和 B</span>
    AbstractFactory<span class="token operator">*</span> factory1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteFactory1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    AbstractProductA<span class="token operator">*</span> productA1 <span class="token operator">=</span> factory1<span class="token operator">-</span><span class="token operator">></span><span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    AbstractProductB<span class="token operator">*</span> productB1 <span class="token operator">=</span> factory1<span class="token operator">-</span><span class="token operator">></span><span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    productA1<span class="token operator">-</span><span class="token operator">></span><span class="token function">useA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productB1<span class="token operator">-</span><span class="token operator">></span><span class="token function">useB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 使用具体工厂 2 创建产品 A 和 B</span>
    AbstractFactory<span class="token operator">*</span> factory2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteFactory2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    AbstractProductA<span class="token operator">*</span> productA2 <span class="token operator">=</span> factory2<span class="token operator">-</span><span class="token operator">></span><span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    AbstractProductB<span class="token operator">*</span> productB2 <span class="token operator">=</span> factory2<span class="token operator">-</span><span class="token operator">></span><span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    productA2<span class="token operator">-</span><span class="token operator">></span><span class="token function">useA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productB2<span class="token operator">-</span><span class="token operator">></span><span class="token function">useB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">delete</span> factory1<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> productA1<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> productB1<span class="token punctuation">;</span>

    <span class="token keyword">delete</span> factory2<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> productA2<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> productB2<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们定义了两个抽象产品类 <code>AbstractProductA</code> 和 <code>AbstractProductB</code>，以及它们的具体实现类。然后，我们定义了抽象工厂类 <code>AbstractFactory</code>，它包括两个工厂方法，分别用于创建产品 A 和产品 B。具体工厂类 <code>ConcreteFactory1</code> 和 <code>ConcreteFactory2</code> 分别实现了 <code>AbstractFactory</code>，用于创建不同的产品族。</p><p>抽象工厂模式允许我们在不知道具体产品类的情况下创建一组相关产品，这对于需要保持产品族之间的一致性非常有用。此模式还支持易于替换整个产品族，以满足不同的需求。</p><h2 id="4-建造者模式"><a href="#4-建造者模式" class="headerlink" title="4.建造者模式"></a>4.建造者模式</h2><p>建造者模式（Builder Pattern）是一种创建型设计模式，用于构建一个复杂对象，将构造过程和表示分离。通常情况下，该模式包括一个 Director（指挥者）类、一个抽象 Builder（建造者）接口和具体的 Builder 实现类。</p><p>以下是一个简单的建造者模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>

<span class="token comment" spellcheck="true">// 产品类，即要构建的复杂对象</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">setPartA</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> partA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        partA_ <span class="token operator">=</span> partA<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">setPartB</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> partB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        partB_ <span class="token operator">=</span> partB<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">setPartC</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> partC<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        partC_ <span class="token operator">=</span> partC<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Product parts: "</span> <span class="token operator">&lt;&lt;</span> partA_ <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span> <span class="token operator">&lt;&lt;</span> partB_ <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span> <span class="token operator">&lt;&lt;</span> partC_ <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>string partA_<span class="token punctuation">;</span>
    std<span class="token operator">::</span>string partB_<span class="token punctuation">;</span>
    std<span class="token operator">::</span>string partC_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 抽象 Builder 接口</span>
<span class="token keyword">class</span> <span class="token class-name">Builder</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">buildPartA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">buildPartB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">buildPartC</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> Product <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体 Builder 实现</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteBuilder</span> <span class="token operator">:</span> <span class="token keyword">public</span> Builder <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        product_ <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">buildPartA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        product_<span class="token operator">-</span><span class="token operator">></span><span class="token function">setPartA</span><span class="token punctuation">(</span><span class="token string">"Part A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">buildPartB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        product_<span class="token operator">-</span><span class="token operator">></span><span class="token function">setPartB</span><span class="token punctuation">(</span><span class="token string">"Part B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">buildPartC</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        product_<span class="token operator">-</span><span class="token operator">></span><span class="token function">setPartC</span><span class="token punctuation">(</span><span class="token string">"Part C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Product <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">*</span>product_<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Product<span class="token operator">*</span> product_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 指挥者类，负责构建产品</span>
<span class="token keyword">class</span> <span class="token class-name">Director</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Director</span><span class="token punctuation">(</span>Builder<span class="token operator">*</span> builder<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">builder_</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    Product <span class="token function">construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder_<span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPartA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder_<span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPartB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder_<span class="token operator">-</span><span class="token operator">></span><span class="token function">buildPartC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> builder_<span class="token operator">-</span><span class="token operator">></span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Builder<span class="token operator">*</span> builder_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteBuilder builder<span class="token punctuation">;</span>
    Director <span class="token function">director</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>

    Product product <span class="token operator">=</span> director<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    product<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个产品类 <code>Product</code>，包括三个部分。我们定义了抽象 Builder 接口，包括构建每个部分的方法和获取最终产品的方法。具体 Builder 类 <code>ConcreteBuilder</code> 实现了 Builder 接口，构建了 <code>Product</code> 的各个部分。指挥者类 <code>Director</code> 负责指导 Builder 构建产品。</p><p>使用建造者模式，我们可以按照不同的需求构建不同的产品，而不必关心构建的细节。这种模式尤其适用于构建复杂对象，帮助将构建过程和表示分离，提高了可维护性和可扩展性。</p><h2 id="5-原型模式"><a href="#5-原型模式" class="headerlink" title="5.原型模式"></a>5.原型模式</h2><p>原型模式（Prototype Pattern）是一种创建型设计模式，其主要思想是通过复制现有对象（原型）来创建新对象，而不需要从头开始构建。这种模式通常用于创建成本高昂或复杂的对象，同时可以保持对象的不变性。原型模式基于对象的克隆，可以分为浅拷贝和深拷贝两种。</p><p>以下是一个简单的原型模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>

<span class="token comment" spellcheck="true">// 原型类</span>
<span class="token keyword">class</span> <span class="token class-name">Prototype</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> Prototype<span class="token operator">*</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体原型类 A</span>
<span class="token keyword">class</span> <span class="token class-name">ConcretePrototypeA</span> <span class="token operator">:</span> <span class="token keyword">public</span> Prototype <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Prototype<span class="token operator">*</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcretePrototypeA</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 深拷贝</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcretePrototypeA"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体原型类 B</span>
<span class="token keyword">class</span> <span class="token class-name">ConcretePrototypeB</span> <span class="token operator">:</span> <span class="token keyword">public</span> Prototype <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Prototype<span class="token operator">*</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcretePrototypeB</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 深拷贝</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcretePrototypeB"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Prototype<span class="token operator">*</span> originalA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcretePrototypeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Prototype<span class="token operator">*</span> originalB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcretePrototypeB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 克隆原型对象</span>
    Prototype<span class="token operator">*</span> cloneA <span class="token operator">=</span> originalA<span class="token operator">-</span><span class="token operator">></span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Prototype<span class="token operator">*</span> cloneB <span class="token operator">=</span> originalB<span class="token operator">-</span><span class="token operator">></span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    originalA<span class="token operator">-</span><span class="token operator">></span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cloneA<span class="token operator">-</span><span class="token operator">></span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    originalB<span class="token operator">-</span><span class="token operator">></span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cloneB<span class="token operator">-</span><span class="token operator">></span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">delete</span> originalA<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> cloneA<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> originalB<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> cloneB<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们定义了一个抽象原型类 <code>Prototype</code>，包括克隆方法 <code>clone</code> 和打印方法 <code>print</code>。然后，我们创建了两个具体的原型类 <code>ConcretePrototypeA</code> 和 <code>ConcretePrototypeB</code>，它们实现了克隆方法，并在打印方法中展示自己的类型。</p><p>在 <code>main</code> 函数中，我们首先创建原型对象 <code>originalA</code> 和 <code>originalB</code>，然后通过调用它们的 <code>clone</code> 方法，创建了相应的克隆对象 <code>cloneA</code> 和 <code>cloneB</code>。这些克隆对象与原型对象具有相同的状态，但是是独立的对象。</p><p>原型模式允许我们根据需要克隆对象，而不必重新创建。这对于创建成本高昂或复杂的对象，以及需要保持对象不变性的情况非常有用。需要注意的是，深拷贝和浅拷贝的选择取决于对象内部的状态和结构。在实际应用中，可能需要自定义克隆方法以适应特定需求。</p><h2 id="6-适配器模式"><a href="#6-适配器模式" class="headerlink" title="6.适配器模式"></a>6.适配器模式</h2><p>适配器模式（Adapter Pattern）是一种结构型设计模式，它允许一个类的接口与另一个类的接口兼容。适配器模式主要用于解决两个已有接口之间的不匹配问题，使它们可以一起工作，而不需要修改它们的源代码。</p><p>适配器模式有两种主要类型：类适配器和对象适配器。</p><p><strong>类适配器</strong> 使用多重继承，它继承了被适配类并实现了目标接口。</p><p><strong>对象适配器</strong> 维护一个被适配类的实例，并实现了目标接口，然后委托被适配类的实例来执行相应的操作。</p><p>以下是一个简单的对象适配器模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 目标接口</span>
<span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 被适配类</span>
<span class="token keyword">class</span> <span class="token class-name">Adaptee</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">specificRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Adaptee's specific request."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 对象适配器</span>
<span class="token keyword">class</span> <span class="token class-name">Adapter</span> <span class="token operator">:</span> <span class="token keyword">public</span> Target <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Adapter</span><span class="token punctuation">(</span>Adaptee<span class="token operator">*</span> adaptee<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">adaptee_</span><span class="token punctuation">(</span>adaptee<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        adaptee_<span class="token operator">-</span><span class="token operator">></span><span class="token function">specificRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Adaptee<span class="token operator">*</span> adaptee_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Adaptee adaptee<span class="token punctuation">;</span>
    Target<span class="token operator">*</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Adapter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>adaptee<span class="token punctuation">)</span><span class="token punctuation">;</span>

    adapter<span class="token operator">-</span><span class="token operator">></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">delete</span> adapter<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个目标接口 <code>Target</code>，包括 <code>request</code> 方法。我们还有一个被适配类 <code>Adaptee</code>，它包括 <code>specificRequest</code> 方法，但它的接口与 <code>Target</code> 不兼容。</p><p>然后，我们创建了一个对象适配器 <code>Adapter</code>，它实现了 <code>Target</code> 接口，并维护了一个 <code>Adaptee</code> 的实例。在 <code>Adapter</code> 的 <code>request</code> 方法中，我们将调用委托给 <code>Adaptee</code> 的 <code>specificRequest</code> 方法，从而使 <code>Adaptee</code> 可以与 <code>Target</code> 接口兼容。</p><p>适配器模式在现实中的应用非常广泛，特别是在将旧系统与新系统集成或者使用第三方库时，它可以起到很好的桥梁作用，以确保不同接口之间的兼容性。</p><p><strong>类适配器</strong></p><p>类适配器模式使用多重继承来实现适配，它继承了被适配类并实现了目标接口。以下是一个简单的类适配器模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 目标接口</span>
<span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 被适配类</span>
<span class="token keyword">class</span> <span class="token class-name">Adaptee</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">specificRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Adaptee's specific request."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 类适配器，继承自 Adaptee 和实现 Target 接口</span>
<span class="token keyword">class</span> <span class="token class-name">Adapter</span> <span class="token operator">:</span> <span class="token keyword">public</span> Adaptee<span class="token punctuation">,</span> <span class="token keyword">public</span> Target <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token function">specificRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 调用 Adaptee 的方法</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Target<span class="token operator">*</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Adapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    adapter<span class="token operator">-</span><span class="token operator">></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">delete</span> adapter<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个目标接口 <code>Target</code>，包括 <code>request</code> 方法。我们还有一个被适配类 <code>Adaptee</code>，它包括 <code>specificRequest</code> 方法，但它的接口与 <code>Target</code> 不兼容。</p><p>然后，我们创建了一个类适配器 <code>Adapter</code>，它继承自 <code>Adaptee</code> 并实现了 <code>Target</code> 接口。在 <code>Adapter</code> 的 <code>request</code> 方法中，我们可以直接调用 <code>specificRequest</code> 方法，因为 <code>Adapter</code> 继承了 <code>Adaptee</code>。</p><p>类适配器模式使用多重继承，这使得它可以同时继承多个类，但也可能引入一些复杂性。适配器模式可用于解决现有系统的接口不兼容问题，同时不需要修改被适配类的源代码。</p><h2 id="7-装饰器模式"><a href="#7-装饰器模式" class="headerlink" title="7.装饰器模式"></a>7.装饰器模式</h2><p>装饰器模式（Decorator Pattern）是一种结构型设计模式，它允许你通过将对象包装在装饰器类的实例中来动态地扩展其行为，而不需要修改其源代码。装饰器模式通常用于以下情况：</p><ol><li>动态地给对象添加功能，而不是静态继承；</li><li>需要遵循开放/封闭原则，即对扩展是开放的，对修改是封闭的；</li><li>需要通过一系列可重用的装饰器来组合不同的行为。</li></ol><p>以下是一个简单的装饰器模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 抽象组件接口</span>
<span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体组件</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteComponent</span> <span class="token operator">:</span> <span class="token keyword">public</span> Component <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteComponent operation."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 抽象装饰器</span>
<span class="token keyword">class</span> <span class="token class-name">Decorator</span> <span class="token operator">:</span> <span class="token keyword">public</span> Component <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Decorator</span><span class="token punctuation">(</span>Component<span class="token operator">*</span> component<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">component_</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        component_<span class="token operator">-</span><span class="token operator">></span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Component<span class="token operator">*</span> component_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体装饰器 A</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteDecoratorA</span> <span class="token operator">:</span> <span class="token keyword">public</span> Decorator <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteDecoratorA</span><span class="token punctuation">(</span>Component<span class="token operator">*</span> component<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Decorator</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        Decorator<span class="token operator">::</span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteDecoratorA operation."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体装饰器 B</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteDecoratorB</span> <span class="token operator">:</span> <span class="token keyword">public</span> Decorator <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteDecoratorB</span><span class="token punctuation">(</span>Component<span class="token operator">*</span> component<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Decorator</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        Decorator<span class="token operator">::</span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteDecoratorB operation."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Component<span class="token operator">*</span> component <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Component<span class="token operator">*</span> decoratorA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteDecoratorA</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Component<span class="token operator">*</span> decoratorB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteDecoratorB</span><span class="token punctuation">(</span>decoratorA<span class="token punctuation">)</span><span class="token punctuation">;</span>

    component<span class="token operator">-</span><span class="token operator">></span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 基本组件操作</span>
    decoratorA<span class="token operator">-</span><span class="token operator">></span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 增加了装饰器 A 的操作</span>
    decoratorB<span class="token operator">-</span><span class="token operator">></span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 增加了装饰器 A 和装饰器 B 的操作</span>

    <span class="token keyword">delete</span> component<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> decoratorA<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> decoratorB<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个抽象组件接口 <code>Component</code>，包括 <code>operation</code> 方法。具体组件 <code>ConcreteComponent</code> 实现了这个接口。</p><p>然后，我们定义了抽象装饰器 <code>Decorator</code>，它也实现了 <code>Component</code> 接口，但在 <code>operation</code> 方法中调用了包装的组件的 <code>operation</code> 方法。具体装饰器类 <code>ConcreteDecoratorA</code> 和 <code>ConcreteDecoratorB</code> 扩展了 <code>Decorator</code> 类，分别增加了特定的操作。</p><p>在 <code>main</code> 函数中，我们创建了一个基本组件 <code>component</code>，然后依次用装饰器 <code>decoratorA</code> 和 <code>decoratorB</code> 包装它。通过这样的嵌套，我们可以动态地添加不同的行为，而不需要修改组件的源代码。</p><p>装饰器模式允许我们以一种灵活的方式组合对象，以满足不同需求。这可以帮助我们遵循开放/封闭原则，同时保持代码的可维护性和可扩展性。</p><h2 id="8-代理模式"><a href="#8-代理模式" class="headerlink" title="8.代理模式"></a>8.代理模式</h2><p>代理模式（Proxy Pattern）是一种结构型设计模式，它允许你提供一个代理类，控制对其他对象的访问。代理模式通常用于以下情况：</p><ol><li>远程代理：代理对象控制对远程对象的访问，例如通过网络。</li><li>虚拟代理：代理对象控制对创建开销大的对象的访问，只在需要时创建。</li><li>保护代理：代理对象控制对对象的访问权限，用于权限控制等。</li><li>智能引用：代理对象添加额外的逻辑，例如引用计数、懒加载等。</li></ol><p>以下是一个简单的代理模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 抽象主题</span>
<span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体主题</span>
<span class="token keyword">class</span> <span class="token class-name">RealSubject</span> <span class="token operator">:</span> <span class="token keyword">public</span> Subject <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"RealSubject handles the request."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 代理</span>
<span class="token keyword">class</span> <span class="token class-name">Proxy</span> <span class="token operator">:</span> <span class="token keyword">public</span> Subject <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Proxy</span><span class="token punctuation">(</span>Subject<span class="token operator">*</span> realSubject<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">realSubject_</span><span class="token punctuation">(</span>realSubject<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            realSubject_<span class="token operator">-</span><span class="token operator">></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">logAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Access denied."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">bool</span> <span class="token function">checkAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 检查访问权限的逻辑</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">logAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 记录访问日志的逻辑</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Access logged."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Subject<span class="token operator">*</span> realSubject_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RealSubject realSubject<span class="token punctuation">;</span>
    Proxy <span class="token function">proxy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>realSubject<span class="token punctuation">)</span><span class="token punctuation">;</span>

    proxy<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个抽象主题 <code>Subject</code>，包括 <code>request</code> 方法。具体主题 <code>RealSubject</code> 实现了这个接口，用于处理请求。</p><p>然后，我们创建了代理 <code>Proxy</code>，它也实现了 <code>Subject</code> 接口。在 <code>Proxy</code> 的 <code>request</code> 方法中，我们可以添加额外的逻辑，例如检查访问权限和记录访问日志。如果权限检查通过，它将委托给实际主题 <code>RealSubject</code> 来处理请求。</p><p>代理模式使我们能够控制对对象的访问，同时可以添加各种额外的功能，例如权限控制、懒加载、缓存等。这对于保持代码的可维护性和可扩展性非常有帮助。</p><h2 id="9-观察者模式"><a href="#9-观察者模式" class="headerlink" title="9.观察者模式"></a>9.观察者模式</h2><p>观察者模式（Observer Pattern）是一种行为型设计模式，它定义了一种一对多的依赖关系，使一个对象的状态发生变化时，其所有依赖者（观察者）都会收到通知并自动更新。观察者模式通常用于以下情况：</p><ol><li>当一个对象的状态变化需要通知其他对象，而且这些对象的数量和类型是未知的。</li><li>当一个对象需要在不知道具体操作的情况下通知其他对象。</li><li>当一个对象需要维护一系列依赖关系，以便在状态变化时能够通知所有依赖者。</li></ol><p>观察者模式包含以下几个关键角色：</p><ol><li><strong>主题（Subject）</strong>：主题是被观察的对象，它包含一组观察者对象，并提供方法来添加、删除和通知观察者。</li><li><strong>观察者（Observer）</strong>：观察者是接收主题通知的对象，它定义了更新方法，以便在主题状态发生变化时能够执行相应操作。</li></ol><p>以下是一个简单的观察者模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token comment" spellcheck="true">// 观察者接口</span>
<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> message<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 主题接口</span>
<span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">addObserver</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> observer<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">removeObserver</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> observer<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> message<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体观察者</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteObserver</span> <span class="token operator">:</span> <span class="token keyword">public</span> Observer <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteObserver</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">name_</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> message<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> name_ <span class="token operator">&lt;&lt;</span> <span class="token string">" received message: "</span> <span class="token operator">&lt;&lt;</span> message <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>string name_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体主题</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteSubject</span> <span class="token operator">:</span> <span class="token keyword">public</span> Subject <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">addObserver</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> observer<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        observers_<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">removeObserver</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> observer<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 寻找并移除观察者</span>
        <span class="token keyword">auto</span> it <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span>observers_<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> observers_<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> observers_<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            observers_<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> message<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>Observer<span class="token operator">*</span> observer <span class="token operator">:</span> observers_<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            observer<span class="token operator">-</span><span class="token operator">></span><span class="token function">update</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Observer<span class="token operator">*</span><span class="token operator">></span> observers_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteSubject subject<span class="token punctuation">;</span>
    ConcreteObserver <span class="token function">observer1</span><span class="token punctuation">(</span><span class="token string">"Observer 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ConcreteObserver <span class="token function">observer2</span><span class="token punctuation">(</span><span class="token string">"Observer 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>observer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>observer2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    subject<span class="token punctuation">.</span><span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token string">"Hello, observers!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    subject<span class="token punctuation">.</span><span class="token function">removeObserver</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>observer1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    subject<span class="token punctuation">.</span><span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token string">"Observers after removal."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们定义了观察者接口 <code>Observer</code> 和主题接口 <code>Subject</code>，分别包括添加、移除和通知观察者的方法。然后，我们创建了具体的观察者类 <code>ConcreteObserver</code> 和具体的主题类 <code>ConcreteSubject</code>。</p><p>在 <code>main</code> 函数中，我们创建主题对象 <code>subject</code> 和两个观察者对象 <code>observer1</code> 和 <code>observer2</code>。我们将观察者添加到主题中，然后主题通知观察者时，它们会接收到消息并执行相应的操作。</p><p>观察者模式使对象之间的关系松散，允许主题和观察者之间的独立变化，同时保持了对象之间的协作。这种模式常用于实现事件处理、发布-订阅系统以及任何需要实现对象之间松耦合通信的情况。</p><h2 id="10-策略模式"><a href="#10-策略模式" class="headerlink" title="10.策略模式"></a>10.策略模式</h2><p>策略模式（Strategy Pattern）是一种行为型设计模式，它允许定义一系列算法，并将每个算法封装到独立的策略类中，使这些算法可以互相替换。策略模式的核心思想是将算法的选择与使用分离，从而实现更灵活的算法切换，同时不需要修改上下文类的代码。</p><p>策略模式包含以下几个主要角色：</p><ol><li><strong>上下文（Context）</strong>：上下文类包含一个策略接口的引用，它可以在运行时切换不同的策略对象，以实现不同的行为。上下文类不直接实现算法，而是将算法委托给策略对象。</li><li><strong>策略（Strategy）</strong>：策略是一个接口或抽象类，定义了一个算法族的接口，具体的策略类实现了这个接口，每个策略类代表一个具体的算法。</li></ol><p>使用策略模式的主要优点包括：</p><ul><li>算法的可独立替换性：可以在运行时切换算法，而不需要修改上下文类的代码。</li><li>降低了上下文类的复杂性：上下文类只需要关注如何选择和使用策略，而不需要实现具体算法。</li><li>提高了代码的可维护性和可扩展性：每个策略类可以独立开发和测试，容易新增新的策略。</li></ul><p>以下是一个简单的策略模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 策略接口</span>
<span class="token keyword">class</span> <span class="token class-name">Strategy</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">doOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体策略 A</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteStrategyA</span> <span class="token operator">:</span> <span class="token keyword">public</span> Strategy <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">doOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Using Strategy A"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体策略 B</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteStrategyB</span> <span class="token operator">:</span> <span class="token keyword">public</span> Strategy <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">doOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Using Strategy B"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 上下文</span>
<span class="token keyword">class</span> <span class="token class-name">Context</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Context</span><span class="token punctuation">(</span>Strategy<span class="token operator">*</span> strategy<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">strategy_</span><span class="token punctuation">(</span>strategy<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">setStrategy</span><span class="token punctuation">(</span>Strategy<span class="token operator">*</span> strategy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        strategy_ <span class="token operator">=</span> strategy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">executeStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        strategy_<span class="token operator">-</span><span class="token operator">></span><span class="token function">doOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Strategy<span class="token operator">*</span> strategy_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteStrategyA strategyA<span class="token punctuation">;</span>
    ConcreteStrategyB strategyB<span class="token punctuation">;</span>

    Context <span class="token function">context</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>strategyA<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">executeStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    context<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>strategyB<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">executeStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个策略接口 <code>Strategy</code>，定义了算法族的接口。然后，我们创建了两个具体策略类 <code>ConcreteStrategyA</code> 和 <code>ConcreteStrategyB</code>，分别实现了不同的算法。</p><p>上下文类 <code>Context</code> 包含一个策略对象的引用，它可以在运行时切换不同的策略。当调用 <code>executeStrategy</code> 方法时，上下文类会委托策略对象执行相应的算法。</p><p>策略模式的应用范围很广，可以用于任何需要动态地选择算法的场景，例如排序算法、计算费用、路由策略等。</p><h2 id="11-命令模式"><a href="#11-命令模式" class="headerlink" title="11.命令模式"></a>11.命令模式</h2><p>命令模式（Command Pattern）是一种行为型设计模式，它将请求封装成一个对象，从而允许你参数化不同的请求、将请求排队、记录请求日志，或者支持可撤销的操作。命令模式的核心思想是将请求的发送者与请求的接收者解耦。</p><p>命令模式包含以下几个主要角色：</p><ol><li><strong>命令（Command）</strong>：命令是一个抽象类或接口，它定义了执行请求的方法 <code>execute</code>。具体的命令类将实现这个接口，将请求参数绑定到接收者，并在 <code>execute</code> 方法中执行具体的操作。</li><li><strong>具体命令（Concrete Command）</strong>：具体命令是命令接口的具体实现，它包括一个接收者对象，负责执行具体的操作。</li><li><strong>接收者（Receiver）</strong>：接收者是具体命令类的执行者，它包含了具体的业务逻辑，命令类将请求委派给接收者来执行。</li><li><strong>调用者（Invoker）</strong>：调用者是负责向命令对象发送请求的对象，它不需要了解命令是如何执行的，只需要将请求发送给命令对象。</li></ol><p>命令模式的主要优点包括：</p><ul><li>解耦命令发送者和命令执行者。</li><li>支持撤销和重做操作。</li><li>支持命令的组合，可以构建复杂的命令序列。</li></ul><p>以下是一个简单的命令模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 命令接口</span>
<span class="token keyword">class</span> <span class="token class-name">Command</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体命令</span>
<span class="token keyword">class</span> <span class="token class-name">LightOnCommand</span> <span class="token operator">:</span> <span class="token keyword">public</span> Command <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">LightOnCommand</span><span class="token punctuation">(</span>Light<span class="token operator">&amp;</span> light<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">light_</span><span class="token punctuation">(</span>light<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        light_<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Light<span class="token operator">&amp;</span> light_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 接收者</span>
<span class="token keyword">class</span> <span class="token class-name">Light</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Light is on"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Light is off"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 调用者</span>
<span class="token keyword">class</span> <span class="token class-name">RemoteControl</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">setCommand</span><span class="token punctuation">(</span>Command<span class="token operator">*</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        command_ <span class="token operator">=</span> command<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">pressButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        command_<span class="token operator">-</span><span class="token operator">></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Command<span class="token operator">*</span> command_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Light livingRoomLight<span class="token punctuation">;</span>
    LightOnCommand <span class="token function">livingRoomLightOn</span><span class="token punctuation">(</span>livingRoomLight<span class="token punctuation">)</span><span class="token punctuation">;</span>

    RemoteControl remote<span class="token punctuation">;</span>
    remote<span class="token punctuation">.</span><span class="token function">setCommand</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>livingRoomLightOn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    remote<span class="token punctuation">.</span><span class="token function">pressButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个命令接口 <code>Command</code>，定义了 <code>execute</code> 方法。具体命令 <code>LightOnCommand</code> 包含一个接收者对象 <code>Light</code>，在 <code>execute</code> 方法中调用接收者的方法。</p><p>调用者 <code>RemoteControl</code> 通过设置具体命令对象，并调用 <code>pressButton</code> 方法来执行命令。这种方式实现了调用者和接收者的解耦，调用者只需要知道如何发送命令，而不需要知道命令是如何执行的。</p><p>命令模式非常适用于构建可扩展和可维护的系统，特别是需要支持撤销、重做和构建复杂命令序列的情况。</p><h2 id="12-状态模式"><a href="#12-状态模式" class="headerlink" title="12.状态模式"></a>12.状态模式</h2><p>状态模式（State Pattern）是一种行为型设计模式，它允许对象在其内部状态改变时改变其行为。状态模式的核心思想是将不同状态抽象为独立的状态类，使对象能够在运行时切换不同状态，而不需要修改其代码。</p><p>状态模式包含以下几个主要角色：</p><ol><li><strong>上下文（Context）</strong>：上下文类是包含状态的对象，它在运行时可以切换不同的状态对象。上下文类通常包括状态接口的引用，用于与当前状态进行交互。</li><li><strong>状态（State）</strong>：状态是一个抽象类或接口，它定义了一个特定状态的行为。具体的状态类将实现这个接口，每个状态类代表一个具体的状态，并定义了状态下的行为。</li></ol><p>状态模式的主要优点包括：</p><ul><li>将状态的行为封装在独立的状态类中，降低了上下文类的复杂性。</li><li>支持动态切换状态，使对象能够在运行时改变行为。</li><li>易于添加新的状态，同时不需要修改现有代码。</li></ul><p>以下是一个简单的状态模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 状态接口</span>
<span class="token keyword">class</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体状态 A</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteStateA</span> <span class="token operator">:</span> <span class="token keyword">public</span> State <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Handling state A"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体状态 B</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteStateB</span> <span class="token operator">:</span> <span class="token keyword">public</span> State <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Handling state B"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 上下文</span>
<span class="token keyword">class</span> <span class="token class-name">Context</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">setState</span><span class="token punctuation">(</span>State<span class="token operator">*</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state_ <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state_<span class="token operator">-</span><span class="token operator">></span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    State<span class="token operator">*</span> state_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteStateA stateA<span class="token punctuation">;</span>
    ConcreteStateB stateB<span class="token punctuation">;</span>

    Context context<span class="token punctuation">;</span>

    context<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stateA<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    context<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stateB<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个状态接口 <code>State</code>，定义了 <code>handle</code> 方法，具体状态类 <code>ConcreteStateA</code> 和 <code>ConcreteStateB</code> 分别实现了这个接口。</p><p>上下的 <code>Context</code> 包含一个状态对象的引用，它可以在运行时切换不同的状态。当调用 <code>request</code> 方法时，上下文对象会委托给当前状态对象来执行特定的行为。</p><p>状态模式使对象能够根据内部状态的改变而改变行为，这有助于消除大量的条件分支，提高了代码的可维护性和可扩展性。状态模式常用于处理对象的状态机、有限状态机、工作流等场景。</p><h2 id="13-模板方法模式"><a href="#13-模板方法模式" class="headerlink" title="13.模板方法模式"></a>13.模板方法模式</h2><p>模板方法模式（Template Method Pattern）是一种行为型设计模式，它定义了一组算法的骨架，将一些步骤延迟到子类实现。模板方法模式允许子类在不改变算法结构的情况下重新定义算法的某些步骤。</p><p>模板方法模式包含以下几个主要角色：</p><ol><li><strong>模板方法（Template Method）</strong>：模板方法是一个抽象类，它定义了一个算法的骨架，包括一组步骤，其中一些步骤由子类实现。</li><li><strong>具体模板（Concrete Template）</strong>：具体模板类是模板方法的具体实现，它实现了模板方法中定义的具体步骤，其中一些步骤可能由子类实现。</li></ol><p>模板方法模式的主要特点包括：</p><ul><li>定义了一个算法的骨架，其中一些步骤延迟到子类实现。</li><li>子类可以重新定义模板方法中的特定步骤，以满足其特定需求，而无需改变算法的整体结构。</li><li>模板方法模式使得代码重用和扩展变得更加容易。</li></ul><p>以下是一个简单的模板方法模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 模板方法</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractClass</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment" spellcheck="true">// 模板方法定义了算法的骨架，包括一组步骤</span>
    <span class="token keyword">void</span> <span class="token function">templateMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">step1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">step2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">step3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 具体步骤由子类实现</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">step1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">step2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">step3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体模板</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteClassA</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractClass <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">step1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteClassA - Step 1"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">step2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteClassA - Step 2"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">step3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteClassA - Step 3"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ConcreteClassB</span> <span class="token operator">:</span> <span class="token keyword">public</span> AbstractClass <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">step1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteClassB - Step 1"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">step2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteClassB - Step 2"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">step3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteClassB - Step 3"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteClassA a<span class="token punctuation">;</span>
    ConcreteClassB b<span class="token punctuation">;</span>

    a<span class="token punctuation">.</span><span class="token function">templateMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">.</span><span class="token function">templateMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个抽象类 <code>AbstractClass</code>，它定义了一个模板方法 <code>templateMethod</code>，包括一组步骤（<code>step1</code>、<code>step2</code>、<code>step3</code>）。具体的步骤由子类实现。具体子类 <code>ConcreteClassA</code> 和 <code>ConcreteClassB</code> 分别实现了这些步骤。</p><p>当我们调用 <code>templateMethod</code> 时，模板方法会按照定义的算法骨架执行各个步骤。不同的子类可以重新定义这些步骤，以满足其特定需求。</p><p>模板方法模式非常适用于需要定义算法骨架但允许某些步骤由子类自定义的情况，例如，创建框架、工作流程或其他多步骤的操作。这有助于提高代码的可复用性和可维护性。</p><h2 id="14-访问者模式（Visitor）"><a href="#14-访问者模式（Visitor）" class="headerlink" title="14.访问者模式（Visitor）"></a>14.访问者模式（Visitor）</h2><p>访问者模式（Visitor Pattern）是一种行为型设计模式，它用于分离数据结构和数据操作，并允许在不修改数据结构的情况下添加新的操作。访问者模式的核心思想是将数据结构和操作分离，使得数据结构可以在不同的操作下表现不同的行为。</p><p>访问者模式包含以下几个主要角色：</p><ol><li><strong>访问者（Visitor）</strong>：访问者是一个抽象类或接口，它定义了一组访问操作，每个操作对应一个具体的元素类型。</li><li><strong>具体访问者（Concrete Visitor）</strong>：具体访问者是访问者接口的具体实现，每个具体访问者实现了一组具体的访问操作。</li><li><strong>元素（Element）</strong>：元素是一个抽象类或接口，它定义了一个 <code>accept</code> 方法，该方法接受一个访问者对象作为参数，允许访问者访问该元素。</li><li><strong>具体元素（Concrete Element）</strong>：具体元素是元素接口的具体实现，每个具体元素实现了 <code>accept</code> 方法，用于调用访问者的相应操作。</li><li><strong>对象结构（Object Structure）</strong>：对象结构是一个包含多个元素的集合，它通常提供一个接受访问者的方法，用于遍历元素并调用访问者的操作。</li></ol><p>访问者模式的主要优点包括：</p><ul><li>分离了数据结构和数据操作，使得可以添加新的操作而无需修改现有数据结构。</li><li>支持对数据结构进行不同的操作，从而提供更多的灵活性和扩展性。</li><li>使得数据结构可以遵循开闭原则（Open/Closed Principle），即对扩展开放，对修改关闭。</li></ul><p>以下是一个简单的访问者模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token comment" spellcheck="true">// 前向声明，让元素类知道访问者类</span>
<span class="token keyword">class</span> <span class="token class-name">Visitor</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 元素接口</span>
<span class="token keyword">class</span> <span class="token class-name">Element</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span>Visitor<span class="token operator">&amp;</span> visitor<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体元素 A</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteElementA</span> <span class="token operator">:</span> <span class="token keyword">public</span> Element <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span>Visitor<span class="token operator">&amp;</span> visitor<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        visitor<span class="token punctuation">.</span><span class="token function">visitElementA</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">operationA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Operation A on ConcreteElementA"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体元素 B</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteElementB</span> <span class="token operator">:</span> <span class="token keyword">public</span> Element <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span>Visitor<span class="token operator">&amp;</span> visitor<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        visitor<span class="token punctuation">.</span><span class="token function">visitElementB</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">operationB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Operation B on ConcreteElementB"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 访问者接口</span>
<span class="token keyword">class</span> <span class="token class-name">Visitor</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">visitElementA</span><span class="token punctuation">(</span>ConcreteElementA<span class="token operator">&amp;</span> element<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">visitElementB</span><span class="token punctuation">(</span>ConcreteElementB<span class="token operator">&amp;</span> element<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体访问者</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteVisitor</span> <span class="token operator">:</span> <span class="token keyword">public</span> Visitor <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">visitElementA</span><span class="token punctuation">(</span>ConcreteElementA<span class="token operator">&amp;</span> element<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">operationA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">visitElementB</span><span class="token punctuation">(</span>ConcreteElementB<span class="token operator">&amp;</span> element<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">operationB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteElementA elementA<span class="token punctuation">;</span>
    ConcreteElementB elementB<span class="token punctuation">;</span>
    ConcreteVisitor visitor<span class="token punctuation">;</span>

    elementA<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>visitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    elementB<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>visitor<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有两种具体元素 <code>ConcreteElementA</code> 和 <code>ConcreteElementB</code>，它们都实现了元素接口，并提供了 <code>accept</code> 方法，以允许访问者访问这些元素。</p><p>具体访问者 <code>ConcreteVisitor</code> 实现了访问者接口中定义的访问操作，其中包括操作 A 和操作 B。</p><p>通过访问者模式，我们可以在不修改元素类的情况下，为元素类添加新的操作（在这个示例中是操作 A 和操作 B）。这种分离数据结构和操作的设计模式使得代码更加灵活和可维护。</p><h2 id="15-组合模式（Composite）"><a href="#15-组合模式（Composite）" class="headerlink" title="15.组合模式（Composite）"></a>15.组合模式（Composite）</h2><p>组合模式（Composite Pattern）是一种结构型设计模式，用于将对象组合成树状结构以表示“部分-整体”的层次结构。组合模式允许客户端以一致的方式处理单个对象和对象组合。</p><p>组合模式包含以下几个主要角色：</p><ol><li><strong>组件（Component）</strong>：组件是一个抽象类或接口，它声明了管理子组件的方法，以及其他操作的接口。</li><li><strong>叶子（Leaf）</strong>：叶子是组件的具体实现，它表示树结构中的叶子节点，不包含子组件。</li><li><strong>容器（Composite）</strong>：容器是组件的具体实现，它表示树结构中的分支节点，可以包含子组件。容器类通常会实现管理子组件的方法。</li></ol><p>组合模式的主要优点包括：</p><ul><li>客户端可以以一致的方式处理单个对象和对象组合，无需知道具体组件的类型。</li><li>可以递归地构建复杂的对象结构，使代码具有更高的可扩展性。</li><li>通过组合模式，可以更容易地添加新的组件类型。</li></ul><p>以下是一个简单的组合模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token comment" spellcheck="true">// 抽象组件</span>
<span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 叶子组件</span>
<span class="token keyword">class</span> <span class="token class-name">Leaf</span> <span class="token operator">:</span> <span class="token keyword">public</span> Component <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Leaf operation"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 容器组件</span>
<span class="token keyword">class</span> <span class="token class-name">Composite</span> <span class="token operator">:</span> <span class="token keyword">public</span> Component <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Composite operation"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 调用子组件的操作</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>Component<span class="token operator">*</span> child <span class="token operator">:</span> children_<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            child<span class="token operator">-</span><span class="token operator">></span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>Component<span class="token operator">*</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        children_<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Component<span class="token operator">*</span><span class="token operator">></span> children_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Leaf leaf1<span class="token punctuation">,</span> leaf2<span class="token punctuation">;</span>
    Composite composite<span class="token punctuation">;</span>

    composite<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>leaf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    composite<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>leaf2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    composite<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个抽象组件 <code>Component</code>，包括一个操作方法 <code>operation</code>。<code>Leaf</code> 类是叶子组件，它是组件的具体实现，而 <code>Composite</code> 类是容器组件，它可以包含多个子组件。</p><p>在 <code>main</code> 函数中，我们创建了两个叶子组件和一个容器组件，并将叶子组件添加到容器组件中。当调用容器组件的 <code>operation</code> 方法时，它会递归调用其子组件的 <code>operation</code> 方法，从而实现了整体-部分的层次结构。</p><p>组合模式常用于处理树状结构，例如文件系统、图形界面控件、组织架构等情况，其中可以递归地组合和管理各种对象。</p><h2 id="16-迭代器模式"><a href="#16-迭代器模式" class="headerlink" title="16.迭代器模式"></a>16.迭代器模式</h2><p>迭代器模式（Iterator Pattern）是一种行为型设计模式，用于提供一种访问聚合对象中各个元素的方法，而无需暴露聚合对象的内部表示。迭代器模式将遍历聚合对象的操作封装在一个迭代器对象中，使客户端能够以一致的方式遍历不同类型的聚合对象。</p><p>迭代器模式包含以下几个主要角色：</p><ol><li><strong>迭代器（Iterator）</strong>：迭代器是一个抽象接口，它定义了用于遍历聚合对象的方法，包括移动到下一个元素、检查是否还有元素等操作。</li><li><strong>具体迭代器（Concrete Iterator）</strong>：具体迭代器是迭代器接口的具体实现，它实现了在特定聚合对象上的遍历方法。</li><li><strong>聚合（Aggregate）</strong>：聚合是一个抽象接口，它定义了用于创建迭代器的方法。</li><li><strong>具体聚合（Concrete Aggregate）</strong>：具体聚合是聚合接口的具体实现，它包含了一组元素，可以生成相应的具体迭代器。</li></ol><p>迭代器模式的主要优点包括：</p><ul><li>客户端可以通过迭代器以一致的方式遍历不同类型的聚合对象，无需关心具体的数据结构。</li><li>迭代器模式将遍历操作封装在独立的迭代器对象中，使聚合对象的结构保持私有，提高了封装性。</li><li>支持多种迭代方式，例如正向遍历、反向遍历、跳跃式遍历等。</li></ul><p>以下是一个简单的迭代器模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token comment" spellcheck="true">// 抽象迭代器</span>
<span class="token keyword">class</span> <span class="token class-name">Iterator</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">bool</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体迭代器</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteIterator</span> <span class="token operator">:</span> <span class="token keyword">public</span> Iterator <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteIterator</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> collection<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">collection_</span><span class="token punctuation">(</span>collection<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">index_</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> collection_<span class="token punctuation">[</span>index_<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> index_ <span class="token operator">&lt;</span> collection_<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> collection_<span class="token punctuation">;</span>
    <span class="token keyword">int</span> index_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 抽象聚合</span>
<span class="token keyword">class</span> <span class="token class-name">Aggregate</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> Iterator<span class="token operator">*</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体聚合</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteAggregate</span> <span class="token operator">:</span> <span class="token keyword">public</span> Aggregate <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteAggregate</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> collection<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">collection_</span><span class="token punctuation">(</span>collection<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    Iterator<span class="token operator">*</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteIterator</span><span class="token punctuation">(</span>collection_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> collection_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    ConcreteAggregate <span class="token function">aggregate</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Iterator<span class="token operator">*</span> iterator <span class="token operator">=</span> aggregate<span class="token punctuation">.</span><span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token operator">-</span><span class="token operator">></span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> iterator<span class="token operator">-</span><span class="token operator">></span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">delete</span> iterator<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个抽象迭代器 <code>Iterator</code>，具体迭代器 <code>ConcreteIterator</code>，抽象聚合 <code>Aggregate</code>，以及具体聚合 <code>ConcreteAggregate</code>。</p><p>具体聚合 <code>ConcreteAggregate</code> 包含了一组整数元素，并提供了创建迭代器的方法。具体迭代器 <code>ConcreteIterator</code> 实现了在集合上的遍历操作。</p><p>在 <code>main</code> 函数中，我们创建了一个包含整数的聚合对象，然后创建了一个迭代器对象，通过迭代器以一致的方式遍历聚合中的元素。这种设计模式使得客户端可以在不关心聚合内部结构的情况下进行遍历操作。</p><h2 id="17-中介者模式（Mediator）"><a href="#17-中介者模式（Mediator）" class="headerlink" title="17.中介者模式（Mediator）"></a>17.中介者模式（Mediator）</h2><p>中介者模式（Mediator Pattern）是一种行为型设计模式，它用于减少对象之间的直接通信，将对象间的交互通过一个中介者对象进行协调和控制。中介者模式有助于降低系统中对象之间的耦合度，使系统更易维护和扩展。</p><p>中介者模式包含以下几个主要角色：</p><ol><li><strong>中介者（Mediator）</strong>：中介者是一个接口或抽象类，它定义了对象之间交互的方法，包括注册、通知、协调等。</li><li><strong>具体中介者（Concrete Mediator）</strong>：具体中介者是中介者接口的具体实现，它协调各个相关对象之间的交互，并维护对象之间的引用。</li><li><strong>同事类（Colleague）</strong>：同事类是相互交互的对象，它们通过中介者来进行通信，而不直接依赖其他同事类。</li></ol><p>中介者模式的主要优点包括：</p><ul><li>降低了对象之间的直接耦合，使系统更加灵活和可维护。</li><li>可以集中控制对象之间的交互，使系统的交互逻辑更清晰。</li><li>支持新增和删除同事类，对系统扩展更加友好。</li></ul><p>以下是一个简单的中介者模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>

<span class="token comment" spellcheck="true">// 抽象中介者</span>
<span class="token keyword">class</span> <span class="token class-name">Mediator</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> message<span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Colleague</span><span class="token operator">*</span> colleague<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体中介者</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteMediator</span> <span class="token operator">:</span> <span class="token keyword">public</span> Mediator <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> message<span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Colleague</span><span class="token operator">*</span> colleague<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Message from "</span> <span class="token operator">&lt;&lt;</span> colleague<span class="token operator">-</span><span class="token operator">></span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">": "</span> <span class="token operator">&lt;&lt;</span> message <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 同事类</span>
<span class="token keyword">class</span> <span class="token class-name">Colleague</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Colleague</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">,</span> Mediator<span class="token operator">*</span> mediator<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">name_</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mediator_</span><span class="token punctuation">(</span>mediator<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mediator_<span class="token operator">-</span><span class="token operator">></span><span class="token function">sendMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name_<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>string name_<span class="token punctuation">;</span>
    Mediator<span class="token operator">*</span> mediator_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteMediator mediator<span class="token punctuation">;</span>
    Colleague <span class="token function">colleague1</span><span class="token punctuation">(</span><span class="token string">"Colleague 1"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Colleague <span class="token function">colleague2</span><span class="token punctuation">(</span><span class="token string">"Colleague 2"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>

    colleague1<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token string">"Hello from Colleague 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    colleague2<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token string">"Hi from Colleague 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有一个抽象中介者 <code>Mediator</code>，具体中介者 <code>ConcreteMediator</code>，以及两个同事类 <code>Colleague</code>。同事类通过中介者来发送消息，而不直接与其他同事类进行通信。</p><p>中介者模式在协调对象之间的交互时非常有用，特别是在大型系统中，当对象之间的交互关系复杂时，可以通过引入中介者来简化和集中控制交互逻辑。这有助于减少系统的复杂性和提高可维护性。</p><h2 id="18-备忘录模式（Memento）"><a href="#18-备忘录模式（Memento）" class="headerlink" title="18.备忘录模式（Memento）"></a>18.备忘录模式（Memento）</h2><p>备忘录模式（Memento Pattern）是一种行为型设计模式，它用于捕获一个对象的内部状态，并将其保存在一个外部对象中，从而可以在以后将对象恢复到先前的状态。备忘录模式的关键思想是在不破坏封装性的前提下，将对象的状态保存和恢复。</p><p>备忘录模式包含以下几个主要角色：</p><ol><li><strong>发起人（Originator）</strong>：发起人是需要保存状态的对象。它有一个创建备忘录和恢复备忘录的方法。发起人的状态可能会变化，可以使用备忘录来保存不同时间点的状态。</li><li><strong>备忘录（Memento）</strong>：备忘录是保存发起人状态的对象。它包含了发起人在某一时刻的状态信息。</li><li><strong>管理者（Caretaker）</strong>：管理者是用于保存和管理备忘录的对象。它可以保存多个备忘录，以便在需要时恢复发起人的状态。</li></ol><p>备忘录模式的主要优点包括：</p><ul><li>允许在不破坏封装性的情况下保存对象的状态，从而可以实现状态的撤销和恢复操作。</li><li>提供了一种简单的方式来保存和管理对象的历史状态，支持多次撤销操作。</li><li>可以降低发起人对象的复杂性，因为状态保存和恢复的逻辑由备忘录和管理者处理。</li></ul><p>以下是一个简单的备忘录模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>

<span class="token comment" spellcheck="true">// 备忘录类</span>
<span class="token keyword">class</span> <span class="token class-name">Memento</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Memento</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> state<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">state_</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> state_<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>string state_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 发起人类</span>
<span class="token keyword">class</span> <span class="token class-name">Originator</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state_ <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> state_<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Memento <span class="token function">createMemento</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">Memento</span><span class="token punctuation">(</span>state_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">restoreMemento</span><span class="token punctuation">(</span><span class="token keyword">const</span> Memento<span class="token operator">&amp;</span> memento<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state_ <span class="token operator">=</span> memento<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>string state_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 管理者类</span>
<span class="token keyword">class</span> <span class="token class-name">Caretaker</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">saveMemento</span><span class="token punctuation">(</span><span class="token keyword">const</span> Memento<span class="token operator">&amp;</span> memento<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mementos_<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>memento<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Memento <span class="token function">getMemento</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> index <span class="token operator">&lt;</span> mementos_<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> mementos_<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// 返回一个空的备忘录以示错误</span>
        <span class="token keyword">return</span> <span class="token function">Memento</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Memento<span class="token operator">></span> mementos_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Originator originator<span class="token punctuation">;</span>
    Caretaker caretaker<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 设置初始状态并保存备忘录</span>
    originator<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">"State 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    caretaker<span class="token punctuation">.</span><span class="token function">saveMemento</span><span class="token punctuation">(</span>originator<span class="token punctuation">.</span><span class="token function">createMemento</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 修改状态并保存备忘录</span>
    originator<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">"State 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    caretaker<span class="token punctuation">.</span><span class="token function">saveMemento</span><span class="token punctuation">(</span>originator<span class="token punctuation">.</span><span class="token function">createMemento</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 恢复到第一个备忘录状态</span>
    originator<span class="token punctuation">.</span><span class="token function">restoreMemento</span><span class="token punctuation">(</span>caretaker<span class="token punctuation">.</span><span class="token function">getMemento</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Current state: "</span> <span class="token operator">&lt;&lt;</span> originator<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，<code>Originator</code> 类表示发起人，它有一个状态需要保存。<code>Memento</code> 类表示备忘录，它可以保存发起人的状态。<code>Caretaker</code> 类表示管理者，它可以保存和管理备忘录。</p><p>在 <code>main</code> 函数中，我们设置了初始状态，并保存了备忘录。然后，修改状态并再次保存备忘录。最后，我们恢复到第一个备忘录状态，从而实现了状态的撤销和恢复操作。备忘录模式非常有用，特别是在需要实现撤销和恢复功能的应用中。</p><h2 id="19-桥接模式"><a href="#19-桥接模式" class="headerlink" title="19.桥接模式"></a>19.桥接模式</h2><p>桥接模式（Bridge Pattern）是一种结构型设计模式，它用于将抽象部分与实现部分分离，以便它们可以独立地变化。桥接模式的目的是将继承关系转化为组合关系，从而减少类之间的耦合度，提高系统的可扩展性。</p><p>桥接模式包含以下几个主要角色：</p><ol><li><strong>抽象部分（Abstraction）</strong>：抽象部分定义了对实现部分的接口，它维护一个对实现部分的引用，并可以通过委托给实现部分来完成具体的操作。</li><li><strong>扩展抽象部分（Refined Abstraction）</strong>：扩展抽象部分是对抽象部分的扩展，通常会增加一些额外的操作。</li><li><strong>实现部分（Implementor）</strong>：实现部分定义了具体操作的接口，它可以是一个抽象类或接口，也可以是具体类。</li><li><strong>具体实现部分（Concrete Implementor）</strong>：具体实现部分是实现部分的具体实现，它实现了实现部分定义的接口。</li></ol><p>桥接模式的主要优点包括：</p><ul><li>分离抽象部分和实现部分，使它们可以独立变化，增加了系统的灵活性。</li><li>对于不同的抽象部分，可以选择不同的实现部分，从而实现了多样化的组合。</li><li>提高了系统的可扩展性，新的抽象部分和实现部分可以方便地添加。</li></ul><p>以下是一个简单的桥接模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment" spellcheck="true">// 实现部分接口</span>
<span class="token keyword">class</span> <span class="token class-name">Implementor</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">operationImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体实现部分 A</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteImplementorA</span> <span class="token operator">:</span> <span class="token keyword">public</span> Implementor <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">operationImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Concrete Implementor A operation"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 具体实现部分 B</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteImplementorB</span> <span class="token operator">:</span> <span class="token keyword">public</span> Implementor <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">operationImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Concrete Implementor B operation"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 抽象部分</span>
<span class="token keyword">class</span> <span class="token class-name">Abstraction</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Abstraction</span><span class="token punctuation">(</span>Implementor<span class="token operator">*</span> implementor<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">implementor_</span><span class="token punctuation">(</span>implementor<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        implementor_<span class="token operator">-</span><span class="token operator">></span><span class="token function">operationImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Implementor<span class="token operator">*</span> implementor_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 扩展抽象部分</span>
<span class="token keyword">class</span> <span class="token class-name">RefinedAbstraction</span> <span class="token operator">:</span> <span class="token keyword">public</span> Abstraction <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">RefinedAbstraction</span><span class="token punctuation">(</span>Implementor<span class="token operator">*</span> implementor<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Abstraction</span><span class="token punctuation">(</span>implementor<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">additionalOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Additional operation"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Implementor<span class="token operator">*</span> implA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteImplementorA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Implementor<span class="token operator">*</span> implB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteImplementorB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Abstraction<span class="token operator">*</span> abstraction1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Abstraction</span><span class="token punctuation">(</span>implA<span class="token punctuation">)</span><span class="token punctuation">;</span>
    abstraction1<span class="token operator">-</span><span class="token operator">></span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Abstraction<span class="token operator">*</span> abstraction2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">RefinedAbstraction</span><span class="token punctuation">(</span>implB<span class="token punctuation">)</span><span class="token punctuation">;</span>
    abstraction2<span class="token operator">-</span><span class="token operator">></span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static_cast</span><span class="token operator">&lt;</span>RefinedAbstraction<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>abstraction2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">additionalOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">delete</span> implA<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> implB<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> abstraction1<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> abstraction2<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们有两个实现部分：<code>ConcreteImplementorA</code> 和 <code>ConcreteImplementorB</code>，它们实现了 <code>Implementor</code> 接口。然后，我们有抽象部分 <code>Abstraction</code> 和扩展抽象部分 <code>RefinedAbstraction</code>，它们使用实现部分来完成操作。</p><p>在 <code>main</code> 函数中，我们创建了两个不同的实现部分，然后分别将它们与抽象部分和扩展抽象部分组合。通过这种方式，我们可以轻松地改变抽象部分和实现部分的组合，实现不同的操作。这是桥接模式的典型应用。</p><h2 id="20-解释器模式（Interpreter）"><a href="#20-解释器模式（Interpreter）" class="headerlink" title="20.解释器模式（Interpreter）"></a>20.解释器模式（Interpreter）</h2><p>解释器模式（Interpreter Pattern）是一种行为型设计模式，它用于定义一种语言的文法规则，并提供一个解释器来解释语言中的表达式。该模式将一个句子（语法）分解成一系列的解释动作。解释器模式常用于编译器、解析器和领域特定语言的实现中。</p><p>解释器模式包含以下几个主要角色：</p><ol><li><strong>抽象表达式（Abstract Expression）</strong>：抽象表达式定义了解释器的接口，包含一个 <code>interpret</code> 方法用于解释表达式。</li><li><strong>终结符表达式（Terminal Expression）</strong>：终结符表达式是继承自抽象表达式的类，它实现了 <code>interpret</code> 方法用于解释终结符表达式。</li><li><strong>非终结符表达式（Non-terminal Expression）</strong>：非终结符表达式也是继承自抽象表达式的类，它通常包含多个子表达式，并实现了 <code>interpret</code> 方法用于解释非终结符表达式。</li><li><strong>上下文（Context）</strong>：上下文包含要解释的文法规则的信息，通常包含解释器所需的数据。</li><li><strong>客户端（Client）</strong>：客户端创建并配置解释器，然后使用解释器来解释表达式。</li></ol><p>解释器模式的主要优点是可以扩展语言的语法，以及在一些特定领域中解决问题。然而，它也有一些缺点，例如对于复杂的文法规则，解释器模式可能会变得复杂，难以维护。</p><p>以下是一个简单的解释器模式的 C++ 示例：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unordered_map></span></span>

<span class="token comment" spellcheck="true">// 抽象表达式</span>
<span class="token keyword">class</span> <span class="token class-name">Expression</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">interpret</span><span class="token punctuation">(</span>std<span class="token operator">::</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> context<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 终结符表达式</span>
<span class="token keyword">class</span> <span class="token class-name">TerminalExpression</span> <span class="token operator">:</span> <span class="token keyword">public</span> Expression <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">TerminalExpression</span><span class="token punctuation">(</span><span class="token keyword">char</span> variable<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">variable_</span><span class="token punctuation">(</span>variable<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">interpret</span><span class="token punctuation">(</span>std<span class="token operator">::</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> context<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> context<span class="token punctuation">[</span>variable_<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">char</span> variable_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 非终结符表达式</span>
<span class="token keyword">class</span> <span class="token class-name">NonterminalExpression</span> <span class="token operator">:</span> <span class="token keyword">public</span> Expression <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">NonterminalExpression</span><span class="token punctuation">(</span>Expression<span class="token operator">*</span> left<span class="token punctuation">,</span> Expression<span class="token operator">*</span> right<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">left_</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">right_</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">interpret</span><span class="token punctuation">(</span>std<span class="token operator">::</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> context<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">return</span> left_<span class="token operator">-</span><span class="token operator">></span><span class="token function">interpret</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">+</span> right_<span class="token operator">-</span><span class="token operator">></span><span class="token function">interpret</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Expression<span class="token operator">*</span> left_<span class="token punctuation">;</span>
    Expression<span class="token operator">*</span> right_<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> context<span class="token punctuation">;</span>
    context<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    context<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    Expression<span class="token operator">*</span> expression <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">NonterminalExpression</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token function">TerminalExpression</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token function">TerminalExpression</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> result <span class="token operator">=</span> expression<span class="token operator">-</span><span class="token operator">></span><span class="token function">interpret</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>

    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Result: "</span> <span class="token operator">&lt;&lt;</span> result <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

    <span class="token keyword">delete</span> expression<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们创建了一个简单的表达式语言，包括终结符表达式和非终结符表达式。通过解释器模式，我们可以解释这些表达式并计算结果。这个示例是解释器模式的一个简单演示，实际应用中可能会涉及更复杂的语法和解释器。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>设计模式是一种通用的解决问题的模板或蓝图，它们用于解决特定类型的问题，并为软件设计提供了可重用的解决方案。在计算机科学中，有23种广泛接受的经典设计模式，它们通常被分为以下几个类别：</p><ol><li><strong>创建型模式</strong>（Creational Patterns）：这些模式关注对象的创建机制，以便以适当的方式创建对象，隐藏创建的细节。创建型模式包括：</li></ol><ul><li>单例模式（Singleton Pattern）</li><li>工厂模式（Factory Pattern）</li><li>抽象工厂模式（Abstract Factory Pattern）</li><li>建造者模式（Builder Pattern）</li><li>原型模式（Prototype Pattern）</li></ul><p><strong>结构型模式</strong>（Structural Patterns）：这些模式处理对象之间的组合，以便形成更大的结构。结构型模式包括：</p><ul><li>适配器模式（Adapter Pattern）</li><li>桥接模式（Bridge Pattern）</li><li>组合模式（Composite Pattern）</li><li>装饰器模式（Decorator Pattern）</li><li>外观模式（Facade Pattern）</li><li>享元模式（Flyweight Pattern）</li><li>代理模式（Proxy Pattern）</li></ul><p><strong>行为型模式</strong>（Behavioral Patterns）：这些模式关注对象之间的通信、职责分配和协作。行为型模式包括：</p><ul><li>责任链模式（Chain of Responsibility Pattern）</li><li>命令模式（Command Pattern）</li><li>解释器模式（Interpreter Pattern）</li><li>迭代器模式（Iterator Pattern）</li><li>中介者模式（Mediator Pattern）</li><li>备忘录模式（Memento Pattern）</li><li>观察者模式（Observer Pattern）</li><li>状态模式（State Pattern）</li><li>策略模式（Strategy Pattern）</li><li>模板方法模式（Template Method Pattern）</li><li>访问者模式（Visitor Pattern）</li></ul><p>这些经典的设计模式提供了在特定情况下解决问题的有效方法，它们有助于提高软件的可维护性、可扩展性和可重用性。根据应用场景和需求，开发人员可以选择适当的设计模式来构建更健壮、可维护和可扩展的软件系统。</p></div><hr><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/Cpp/"><span class="chip bg-color">Cpp</span> </a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="chip bg-color">设计模式</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="wechat,qq" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments textarea{box-sizing:border-box;background:url(/medias/comment_bg.png) 100% 100% no-repeat}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}.v .vlist .vcard{padding-top:2.5em!important}</style><div class="card valine-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;left:20px;top:15px;padding-bottom:5px"><i class="fa fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="vcomments" class="card-content" style="display:grid"></div></div><script src="/libs/valine/av-min.js"></script><script src="/libs/valine/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"98JpzSGcrl9jFqHO13vqxHvX-gzGzoHsz",appKey:"mDmr2h9PB20xvPMNqgyRnNIC",notify:!0,verify:!0,visitor:!0,avatar:"mm",pageSize:"10",lang:"zh-cn",placeholder:"just go go"})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fa fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/posts/24753/"><div class="card-image"><img src="/medias/featureimages/8.jpg" class="responsive-img" alt="在Linux下为g++链接三方库"> <span class="card-title">在Linux下为g++链接三方库</span></div></a><div class="card-content article-content"><div class="summary block-with-text">想像原生一样使用</div><div class="publish-info"><span class="publish-date"><i class="fa fa-clock-o fa-fw icon-date"></i>2024-04-27 </span><span class="publish-author"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/Cpp/" class="post-category">Cpp</a></span></div></div><div class="card-action article-tags"><a href="/tags/Cpp/"><span class="chip bg-color">Cpp</span> </a><a href="/tags/%E5%B7%A5%E7%A8%8B%E7%BB%8F%E9%AA%8C/"><span class="chip bg-color">工程经验</span> </a><a href="/tags/Linux/"><span class="chip bg-color">Linux</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fa fa-chevron-right"></i></div><div class="card"><a href="/posts/8251/"><div class="card-image"><img src="medias/imgs/zhou.jpg" class="responsive-img" alt="2024,F1上海站"> <span class="card-title">2024,F1上海站</span></div></a><div class="card-content article-content"><div class="summary block-with-text">2024年F1中国站周末结束了，但也许我们终于迎来了一个新的时代的开始</div><div class="publish-info"><span class="publish-date"><i class="fa fa-clock-o fa-fw icon-date"></i>2024-04-26 </span><span class="publish-author"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E6%9D%82%E8%AE%B0/" class="post-category">杂记</a></span></div></div><div class="card-action article-tags"><a href="/tags/%E6%9D%82%E8%AE%B0/"><span class="chip bg-color">杂记</span></a></div></div></div></div></article></div><script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fa fa-list"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),headingSelector:"h2, h3, h4, h5"});let t=0;var e="toc-heading-";$("#toc-content a").each(function(){$(this).attr("href","#"+e+ ++t)}),t=0,$("#articleContent").children("h2, h3, h4, h5").each(function(){$(this).attr("id",e+ ++t)});var n=parseInt(.4*$(window).height()-64);let o=$(".toc-widget");$(window).scroll(function(){var t=$(window).scrollTop();n<t?o.addClass("toc-fixed"):o.removeClass("toc-fixed")});var i="expanded";let a=$("#toc-aside"),c=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){a.hasClass(i)?(a.removeClass(i).hide(),c.removeClass("l9")):(a.addClass(i).show(),c.addClass("l9")),function(){let e=$("#artDetail");if(0!==e.length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#prenext-posts").width(t)}}()})})</script></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2019</span> <a href="/about" rel="external nofollow noreferrer">JoyTsing</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br><span id="sitetime">载入运行时间...</span> <span id="busuanzi_container_site_pv">|&nbsp;<i class="fa fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次 </span><span id="busuanzi_container_site_uv">|&nbsp;<i class="fa fa-user"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br>&nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">763.3k</span>&nbsp;字 <span id="icp"><img src="/medias/icp.png" style="vertical-align:text-bottom" alt="icp"> <a href="https://beian.miit.gov.cn/" target="_blank">陕公网安备61019002002862号 滇ICP备2024026466号-1</a></span><script>function siteTime(){var e=864e5,t="2019",n=(m=new Date).getFullYear(),o=m.getMonth()+1,r=m.getDate(),a=m.getHours(),i=m.getMinutes(),l=m.getSeconds(),m=Date.UTC(t,"7","24","0","0","0"),r=Date.UTC(n,o,r,a,i,l)-m,a=Math.floor(r/31536e6),i=Math.floor(r/e-365*a),l=Math.floor((r-(365*a+i)*e)/36e5),m=Math.floor((r-(365*a+i)*e-36e5*l)/6e4),M=Math.floor((r-(365*a+i)*e-36e5*l-6e4*m)/1e3);t==n?(document.getElementById("year").innerHTML=n,document.getElementById("sitetime").innerHTML="本站已安全运行 "+i+" 天 "+l+" 小时 "+m+" 分钟 "+M+" 秒"):(document.getElementById("year").innerHTML=t+" - "+n,document.getElementById("sitetime").innerHTML="本站已安全运行 "+a+" 年 "+i+" 天 "+l+" 小时 "+m+" 分钟 "+M+" 秒")}setInterval(siteTime,1e3)</script></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/JoyTsing" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i> </a><a href="/medias/wechat.jpg" target="_blank" data-tooltip="添加我的微信: [object Object]" data-position="top" data-delay="50"><i class="fa fa-weixin"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">$(function(){searchFunc("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fa fa-angle-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3a39d92b69933ae56c7eb41ffb9aa2e0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script type="text/javascript">var st,OriginTitile=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="(oﾟvﾟ)ノ Hi",clearTimeout(st)):(document.title="(*´∇｀*) 欢迎回来！",st=setTimeout(function(){document.title=OriginTitile},3e3))})</script><script type="text/javascript" color="0,0,255" pointcolor="0,0,255" opacity="0.8" zindex="-1" count="150" src="/libs/background/canvas-nest.js"></script><script src="/libs/instantpage/instantpage.js" type="module"></script><script src="//cdn.jsdelivr.net/npm/js-base64/base64.min.js"></script><script>const hasAttr = (e,a) => a.some(_=> e.attr(_)!==undefined);
        $('a').each(function() {
          const $this = $(this);
          if(hasAttr($this,["data-fancybox","ignore-external-link"])) return;
          const href = $this.attr('href');
          if (href && href.match('^((http|https|thunder|qqdl|ed2k|Flashget|qbrowser|ftp|rtsp|mms)://)')) {
            const strs = href.split('/');
            if (strs.length >= 3) {
                const host = strs[2];
                if (host !== '' || window.location.host) {
                    $this.attr('href', '/go.html?u='+Base64.encode(href)+'').attr('rel', 'external nofollow noopener noreferrer');
                    if (true) {
                        $this.attr('target', '_blank');
                    }
                }
            }
          }
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"left",width:150,height:200},mobile:{show:!1},react:{opacity:.7}})</script></body></html>